---
layout: post
title: Hack This Site - Realistic - CrappySoft Software
topic: Hack This Site
---

javascript:void(alert("test"));

Welcome back to my walkthrough of hackthissite.org's CTF missions. I will be going through my thought process of how I solved these missions, and therefore also giving away the solutions. If you came across this to give you hints, watch out for spoilers! Good luck, have fun.

Our next realistic mission asks us to hack a website and ensure that the person contacting us gets properly paid for thier work. They supply me with their login information in order to complete this challenge.

My first step for this challenge will be very similar to the last one. I will begin by going through the website, trying to see if I can find some kind of file structure and see if they have anything 'interesting' that I should be keeping in mind. Going through what is accessible prior to loging-in, we can see that the URL `../files/` is accessible and has directory listing off. I was able to deduce this URL from the mailing list page. From here, I can access the logs, the mailing list, and the demo of some software. I will keep this in mind as I start exploring the signed-in section of the website. 

The first thing that I notice when loging-in is that 3 cookies are set client side: `{strUsername, strPassword, intID}`. `strUsername` is the username/email that was used to login encoded in url-encoding. `strPassword` seems to be an encoded version of the password that was used to login; `ilovemywork` was encoded into `5b3de25c4dba60d2102281633d339b48`. Looking at this encoded password, I instantly feel like it seems familiar, my suspicion is that it was hashed using MD5. This assumption was indeed correct as when I independently hash `ilovemywork`, I get the result `5b3de25c4dba60d2102281633d339b48`. `intID` was set to 2. Now that I have loged in, I now have access to two other pages, a 'pay salaries' page and a 'private message' page. Going through the private message page, I notice that we can send messages to 4 different people, including myself. The source code exposes the direct email addresses of these people, which we may need to use later in this challenge. Making a mental note of this, I will now checkout the 'pay salaries' page. Accessing this page, we are instantly presented with the message: "You are not an administrator." which suggests that we do not have the correct cookies in order to access this page. Now, we must figure out which cookies this page uses in order to 'validate' a 'pay salaries' request.

Going back to the private message page, there is an interesting observation to be made. The user that we are currently loged in as is listed as the second one in the dropdown list. Our `intID` cookie is also set to 2, which could suggest that this is somehow correlated? Otherwise, there are 4 users listed, a sales man - which is exactly the same title given to the account I am currently in, thus we can ignore this - an owner and a developer. Whilst it doesn't say 'administrator' we can assume that at least one of those two - owner, developer - are given the 'administrator' access level. It is apparent that we need to 'fake' being one of these people in order to complete this mission. Since there doesn't seem to be any apparent way to find out the passwords of either of these accounts, I will will begin by changing the `strUsername` and `intID` to match up with what is shown in the dropdown list. Changing to the owner had the same "You are not an administrator" message, as is the same with the developer. This suggests that it may check the password cookies to ensure a request is valid.